<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Minimal Tasks UI</title>
  <!-- é™åˆ¶ç¼©æ”¾ï¼šuser-scalable=no + maximum-scale=1 -->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
  />
  <style>
    :root {
      --bg: #f7f7f9;
      --bg-card: #ffffff;
      --border: #e5e7eb;
      --border-soft: #f1f5f9;
      --text: #111827;
      --muted: #6b7280;
      --accent: #2563eb;
      --accent-soft: #eff4ff;
      --radius-lg: 14px;
      --radius-md: 10px;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      justify-content: center;
    }

    .app {
      width: 100%;
      max-width: 520px;
      min-height: 100vh;
      padding: 12px 14px 70px;
    }

    /* é¡¶éƒ¨ */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .header-title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .header-title h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
    }

    .header-title span {
      font-size: 12px;
      color: var(--muted);
    }

    .header-right {
      font-size: 12px;
      color: var(--muted);
    }

    /* Tab å¯¼èˆª */
    .tabs {
      display: flex;
      gap: 6px;
      background: #edf0f4;
      padding: 4px;
      border-radius: 999px;
      margin-bottom: 10px;
    }

    .tab-btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      background: transparent;
      padding: 7px 0;
      font-size: 12px;
      color: var(--muted);
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }

    .tab-btn span.badge {
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 999px;
      background: #e5e7eb;
      color: #4b5563;
    }

    .tab-btn.active {
      background: var(--bg-card);
      color: var(--text);
      box-shadow: 0 1px 2px rgba(15,23,42,0.05);
    }

    .tab-btn.active span.badge {
      background: var(--accent-soft);
      color: var(--accent);
    }

    /* é¢æ¿ */
    .panel {
      display: none;
      margin-top: 8px;
    }
    .panel.active {
      display: block;
    }

    .section-title {
      font-size: 13px;
      font-weight: 500;
      margin: 10px 2px 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .section-title span.count {
      font-size: 11px;
      color: var(--muted);
    }

    .empty {
      padding: 18px 4px;
      font-size: 12px;
      color: var(--muted);
      text-align: center;
    }

    /* ä»Šæ—¥è§†å›¾ï¼šä»»åŠ¡å¡ä»…æ ‡é¢˜+è¯´æ˜+å‹¾é€‰æ¡† */
    .task-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 10px;
    }

    .task-card-today {
      padding: 10px 11px;
      border-radius: var(--radius-lg);
      background: var(--bg-card);
      border: 1px solid var(--border-soft);
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .task-checkbox {
      margin-top: 3px;
      flex-shrink: 0;
    }

    .task-main {
      flex: 1;
      min-width: 0;
    }

    .task-title {
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 2px;
    }

    .task-desc {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }

    .task-title.completed,
    .task-desc.completed {
      text-decoration: line-through;
      color: #9ca3af;
    }

    .overdue-label {
      font-size: 11px;
      color: #b91c1c;
      margin-top: 4px;
    }

    /* ä¸€å‘¨è§†å›¾ï¼šå…­å®«æ ¼ / ç½‘æ ¼ï¼Œä»…æ ‡é¢˜ */
    .week-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
      margin-top: 6px;
    }

    @media (min-width: 420px) {
      .week-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .week-day-card {
      border-radius: var(--radius-md);
      background: var(--bg-card);
      border: 1px solid var(--border-soft);
      padding: 8px 8px 6px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .week-day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 2px;
    }

    .week-day-title {
      font-size: 11px;
      font-weight: 500;
      color: #4b5563;
    }

    .week-day-count {
      font-size: 10px;
      color: var(--muted);
    }

    .week-day-card.today {
      border-color: var(--accent);
      background: #eff6ff;
    }

    .week-tasks {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .week-task-title {
      font-size: 11px;
      color: #374151;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .week-task-title.empty {
      color: var(--muted);
    }

    /* Inbox è§†å›¾ï¼šå³ä¾§ä¸‰ä¸ªå›¾æ ‡æŒ‰é’® */
    .inbox-item {
      padding: 9px 10px;
      border-radius: var(--radius-lg);
      background: var(--bg-card);
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .inbox-main {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .inbox-title {
      font-size: 13px;
      font-weight: 500;
    }

    .inbox-desc {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
    }

    .inbox-actions {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-left: 4px;
    }

    .icon-btn {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #4b5563;
      cursor: pointer;
    }

    .icon-btn:active {
      transform: scale(0.94);
      background: #e5e7eb;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- é¡¶éƒ¨ -->
    <header class="header">
      <div class="header-title">
        <h1>Tasks</h1>
        <span id="todayLabel"></span>
      </div>
      <div class="header-right">
        æç®€è§†å›¾
      </div>
    </header>

    <!-- Tab å¯¼èˆª -->
    <div class="tabs">
      <button class="tab-btn active" data-tab="today">
        ä»Šæ—¥
        <span class="badge" id="badgeToday">0</span>
      </button>
      <button class="tab-btn" data-tab="week">
        ä¸€å‘¨
        <span class="badge" id="badgeWeek">0</span>
      </button>
      <button class="tab-btn" data-tab="inbox">
        Inbox
        <span class="badge" id="badgeInbox">0</span>
      </button>
    </div>

    <!-- ä»Šæ—¥ä»»åŠ¡ -->
    <section class="panel active" data-panel="today">
      <div class="section-title">
        <span>é€¾æœŸä»»åŠ¡</span>
        <span class="count" id="countOverdue">0 é¡¹</span>
      </div>
      <div class="task-list" id="listOverdue"></div>

      <div class="section-title">
        <span>ä»Šæ—¥ä»»åŠ¡</span>
        <span class="count" id="countToday">0 é¡¹</span>
      </div>
      <div class="task-list" id="listToday"></div>
    </section>

    <!-- ä¸€å‘¨ä»»åŠ¡ï¼šå…­å®«æ ¼ -->
    <section class="panel" data-panel="week">
      <div class="section-title">
        <span>æœ¬å‘¨</span>
        <span class="count" id="countWeek">0 é¡¹</span>
      </div>
      <div class="week-grid" id="weekGrid"></div>
    </section>

    <!-- Inbox -->
    <section class="panel" data-panel="inbox">
      <div class="section-title">
        <span>Inboxï¼ˆæœªè®¾æ—¥æœŸï¼‰</span>
        <span class="count" id="countInbox">0 é¡¹</span>
      </div>
      <div class="task-list" id="listInbox"></div>
    </section>
  </div>

  <script>
    // ---- ç¤ºä¾‹ä»»åŠ¡æ•°æ®ï¼šå¢åŠ  description å­—æ®µ ----
    const sampleTasks = [
      {
        id: "1",
        title: "èµ·è‰ä¾›åº”å•†æ¡†æ¶åè®®åˆç¨¿",
        description: "ä¸º A å®¢æˆ·ä¾›åº”é“¾é¡¹ç›®èµ·è‰ç¬¬ä¸€ç‰ˆæ¡†æ¶åè®®ï¼Œå…³æ³¨è¿çº¦è´£ä»»ä¸ä»·æ ¼è°ƒæ•´æœºåˆ¶ã€‚",
        status: "è¿›è¡Œä¸­",
        dueDate: offsetDate(-1),    // æ˜¨å¤©ï¼ˆé€¾æœŸï¼‰
        createdAt: offsetDate(-5)
      },
      {
        id: "2",
        title: "å®¡æ ¸å‘˜å·¥æ‰‹å†Œæ•°æ®åˆè§„ç« èŠ‚",
        description: "æ£€æŸ¥å‘˜å·¥æ‰‹å†Œä¸­æ¶‰åŠä¸ªäººä¿¡æ¯æ”¶é›†ã€ç›‘æ§åŠè·¨å¢ƒä¼ è¾“çš„æ¡æ¬¾ã€‚",
        status: "å¾…åŠ",
        dueDate: todayISO(),
        createdAt: offsetDate(-2)
      },
      {
        id: "3",
        title: "å‡†å¤‡å‘¨äº”å†…éƒ¨åŸ¹è®­ PPT",
        description: "æ•´ç† AI åœ¨åˆåŒå®¡é˜…ä¸­çš„åº”ç”¨ç¤ºä¾‹ï¼Œæ§åˆ¶åœ¨ 20 é¡µä»¥å†…ã€‚",
        status: "å¾…åŠ",
        dueDate: offsetDate(2),
        createdAt: todayISO()
      },
      {
        id: "4",
        title: "è·Ÿè¿›å¾·å›½å•†æ ‡è®¸å¯å…¬è¯è®¤è¯è¦æ±‚",
        description: "ç¡®è®¤å•†æ ‡è®¸å¯åè®®æ˜¯å¦éœ€äº‹å…ˆå…¬è¯å†è¿›è¡Œæµ·ç‰™è®¤è¯ã€‚",
        status: "å¾…åŠ",
        dueDate: offsetDate(4),
        createdAt: offsetDate(-1)
      },
      {
        id: "5",
        title: "è¡¥å½•ä¸Šå‘¨å·¥æ—¶å¹¶æ•´ç†é¡¹ç›®ç¼–å·",
        description: "åœ¨å¿…æ™ºä¸­è¡¥å½•ä¸Šå‘¨æ‰€æœ‰æ¡ˆä»¶å·¥æ—¶ï¼Œæ ¸å¯¹é¡¹ç›®ç¼–ç æ— è¯¯ã€‚",
        status: "å·²å®Œæˆ",
        dueDate: offsetDate(-3),
        createdAt: offsetDate(-7)
      },
      {
        id: "6",
        title: "æ•´ç† Notion ä»»åŠ¡æ•°æ®åº“å­—æ®µ",
        description: "ç»Ÿä¸€ Notion æ•°æ®åº“å±æ€§å‘½åï¼Œæ”¯æŒæ—¥æœŸã€çŠ¶æ€ã€ä¼˜å…ˆçº§ä¸‰ç±»æ ¸å¿ƒå­—æ®µã€‚",
        status: "å¾…åŠ",
        dueDate: null,
        createdAt: todayISO()
      },
      {
        id: "7",
        title: "æ›´æ–°å®¢æˆ· B æ•°æ®è·¨å¢ƒåˆè§„çŸ©é˜µ",
        description: "æ ¹æ®æœ€æ–°æ³•è§„æ›´æ–°ç¾å›½ã€æ¬§ç›Ÿã€ä¸œç›Ÿçš„è·¨å¢ƒè§„åˆ™è¡¨ã€‚",
        status: "è¿›è¡Œä¸­",
        dueDate: offsetDate(5),
        createdAt: todayISO()
      },
      {
        id: "8",
        title: "å­¦ä¹  deepseek OCR è¯†åˆ«æ–¹æ¡ˆ",
        description: "æµ‹è¯• deepseek OCR åœ¨æ‰«æåˆåŒä¸­çš„å¸ƒå±€è¯†åˆ«æ•ˆæœã€‚",
        status: "å¾…åŠ",
        dueDate: null,
        createdAt: offsetDate(-1)
      }
    ];

    // ---- æ—¶é—´å·¥å…·å‡½æ•° ----
    function todayISO() {
      const d = new Date();
      d.setHours(0,0,0,0);
      return d.toISOString();
    }
    function offsetDate(days) {
      const d = new Date();
      d.setDate(d.getDate() + days);
      d.setHours(0,0,0,0);
      return d.toISOString();
    }
    function dateKey(iso) {
      if (!iso) return null;
      return iso.slice(0, 10);
    }
    function isSameDay(a, b) {
      return dateKey(a) === dateKey(b);
    }
    function formatDateShort(iso) {
      const d = new Date(iso);
      return `${d.getMonth() + 1}/${d.getDate()}`;
    }

    function weekdayLabel(d) {
      const map = ["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
      return "å‘¨" + map[d.getDay()];
    }

    function getWeekDates() {
      const today = new Date();
      today.setHours(0,0,0,0);
      const day = today.getDay(); // 0 Sun - 6 Sat
      const mondayOffset = day === 0 ? -6 : 1 - day;
      const days = [];
      for (let i = 0; i < 7; i++) {
        const d = new Date(today);
        d.setDate(today.getDate() + mondayOffset + i);
        d.setHours(0,0,0,0);
        days.push(d);
      }
      return days;
    }

    // ---- æ¸²æŸ“é€»è¾‘ ----
    function render(tasks) {
      const today = todayISO();
      const todayKey = dateKey(today);

      const withDue = tasks.filter(t => t.dueDate);
      const overdue = withDue.filter(t => dateKey(t.dueDate) < todayKey && t.status !== "å·²å®Œæˆ");
      const todayTasks = withDue.filter(t => isSameDay(t.dueDate, today));
      const inbox = tasks.filter(t => !t.dueDate);

      const weekDates = getWeekDates();
      const weekStartKey = dateKey(weekDates[0].toISOString());
      const weekEndKey = dateKey(weekDates[6].toISOString());
      const weekTasks = withDue.filter(t => {
        const k = dateKey(t.dueDate);
        return k >= weekStartKey && k <= weekEndKey;
      });

      // é¡¶éƒ¨è®¡æ•°
      document.getElementById("badgeToday").textContent = overdue.length + todayTasks.length;
      document.getElementById("badgeWeek").textContent = weekTasks.length;
      document.getElementById("badgeInbox").textContent = inbox.length;

      document.getElementById("countOverdue").textContent = overdue.length + " é¡¹";
      document.getElementById("countToday").textContent = todayTasks.length + " é¡¹";
      document.getElementById("countWeek").textContent = weekTasks.length + " é¡¹";
      document.getElementById("countInbox").textContent = inbox.length + " é¡¹";

      // ä»Šæ—¥è§†å›¾
      const listOverdue = document.getElementById("listOverdue");
      const listToday = document.getElementById("listToday");
      listOverdue.innerHTML = "";
      listToday.innerHTML = "";

      if (overdue.length === 0) {
        listOverdue.innerHTML = `<div class="empty">æ²¡æœ‰é€¾æœŸä»»åŠ¡</div>`;
      } else {
        overdue
          .sort((a,b) => a.dueDate.localeCompare(b.dueDate))
          .forEach(t => listOverdue.appendChild(createTodayCard(t, { overdue: true })));
      }

      if (todayTasks.length === 0) {
        listToday.innerHTML = `<div class="empty">ä»Šå¤©æ²¡æœ‰ä»»åŠ¡å®‰æ’</div>`;
      } else {
        todayTasks
          .sort((a,b) => a.title.localeCompare(b.title, "zh-CN"))
          .forEach(t => listToday.appendChild(createTodayCard(t)));
      }

      // ä¸€å‘¨è§†å›¾ï¼šå…­å®«æ ¼
      const weekGrid = document.getElementById("weekGrid");
      weekGrid.innerHTML = "";

      const todayKeyNow = todayKey;

      weekDates.forEach(d => {
        const key = dateKey(d.toISOString());
        const dayTasks = weekTasks.filter(t => dateKey(t.dueDate) === key);

        const card = document.createElement("div");
        card.className = "week-day-card" + (key === todayKeyNow ? " today" : "");

        const header = document.createElement("div");
        header.className = "week-day-header";
        const title = document.createElement("span");
        title.className = "week-day-title";
        title.textContent = `${weekdayLabel(d)} Â· ${formatDateShort(d.toISOString())}`;
        const cnt = document.createElement("span");
        cnt.className = "week-day-count";
        cnt.textContent = `${dayTasks.length} é¡¹`;
        header.appendChild(title);
        header.appendChild(cnt);

        const list = document.createElement("div");
        list.className = "week-tasks";

        if (dayTasks.length === 0) {
          const empty = document.createElement("div");
          empty.className = "week-task-title empty";
          empty.textContent = "æš‚æ— ä»»åŠ¡";
          list.appendChild(empty);
        } else {
          dayTasks
            .sort((a,b) => a.title.localeCompare(b.title, "zh-CN"))
            .forEach(t => {
              const item = document.createElement("div");
              item.className = "week-task-title";
              item.textContent = t.title || "(æœªå‘½åä»»åŠ¡)";
              list.appendChild(item);
            });
        }

        card.appendChild(header);
        card.appendChild(list);
        weekGrid.appendChild(card);
      });

      // Inbox è§†å›¾
      const listInbox = document.getElementById("listInbox");
      listInbox.innerHTML = "";
      if (inbox.length === 0) {
        listInbox.innerHTML = `<div class="empty">æš‚æ—  Inbox ä»»åŠ¡</div>`;
      } else {
        inbox
          .sort((a,b) => (b.createdAt || "").localeCompare(a.createdAt || ""))
          .forEach(t => listInbox.appendChild(createInboxItem(t)));
      }
    }

    // ä»Šæ—¥è§†å›¾å¡ç‰‡ï¼šå‹¾é€‰æ¡†+æ ‡é¢˜+è¯´æ˜
    function createTodayCard(task, opt = {}) {
      const card = document.createElement("div");
      card.className = "task-card-today";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.className = "task-checkbox";
      checkbox.checked = task.status === "å·²å®Œæˆ";

      const main = document.createElement("div");
      main.className = "task-main";

      const title = document.createElement("div");
      title.className = "task-title";
      title.textContent = task.title || "(æœªå‘½åä»»åŠ¡)";

      const desc = document.createElement("div");
      desc.className = "task-desc";
      desc.textContent = task.description || "";

      if (checkbox.checked) {
        title.classList.add("completed");
        desc.classList.add("completed");
      }

      checkbox.addEventListener("change", () => {
        const completed = checkbox.checked;
        title.classList.toggle("completed", completed);
        desc.classList.toggle("completed", completed);
        // è¿™é‡Œå¯ä»¥åç»­å¯¹æ¥ Notion API æ›´æ–°çŠ¶æ€
      });

      main.appendChild(title);
      if (task.description) main.appendChild(desc);

      if (opt.overdue && task.dueDate) {
        const overdue = document.createElement("div");
        overdue.className = "overdue-label";
        overdue.textContent = "å·²é€¾æœŸ";
        main.appendChild(overdue);
      }

      card.appendChild(checkbox);
      card.appendChild(main);
      return card;
    }

    // Inbox è¡Œï¼šå·¦ä¾§æ ‡é¢˜+è¯´æ˜ï¼Œå³ä¾§ä¸‰ä¸ªå›¾æ ‡æŒ‰é’®
    function createInboxItem(task) {
      const row = document.createElement("div");
      row.className = "inbox-item";

      const main = document.createElement("div");
      main.className = "inbox-main";

      const title = document.createElement("div");
      title.className = "inbox-title";
      title.textContent = task.title || "(æœªå‘½åä»»åŠ¡)";

      const desc = document.createElement("div");
      desc.className = "inbox-desc";
      desc.textContent = task.description || "";

      main.appendChild(title);
      if (task.description) main.appendChild(desc);

      const actions = document.createElement("div");
      actions.className = "inbox-actions";

      const btnToday = document.createElement("button");
      btnToday.className = "icon-btn";
      btnToday.title = "è®¾ä¸ºä»Šæ—¥";
      btnToday.textContent = "â˜€ï¸";

      const btnTomorrow = document.createElement("button");
      btnTomorrow.className = "icon-btn";
      btnTomorrow.title = "è®¾ä¸ºæ˜æ—¥";
      btnTomorrow.textContent = "ğŸŒ¤";

      const btnPick = document.createElement("button");
      btnPick.className = "icon-btn";
      btnPick.title = "é€‰æ‹©æ—¥æœŸ";
      btnPick.textContent = "ğŸ“…";

      // è¿™é‡Œå…ˆåªåš UIï¼Œåç»­å¯ä»¥ç»‘å®šå®é™…æ—¥æœŸé€‰æ‹© / Notion æ›´æ–°é€»è¾‘
      btnToday.addEventListener("click", () => {
        console.log("è®¾ä¸ºä»Šæ—¥ï¼š", task.title);
      });
      btnTomorrow.addEventListener("click", () => {
        console.log("è®¾ä¸ºæ˜æ—¥ï¼š", task.title);
      });
      btnPick.addEventListener("click", () => {
        console.log("é€‰æ‹©æ—¥æœŸï¼š", task.title);
      });

      actions.appendChild(btnToday);
      actions.appendChild(btnTomorrow);
      actions.appendChild(btnPick);

      row.appendChild(main);
      row.appendChild(actions);
      return row;
    }

    // Tab åˆ‡æ¢
    function initTabs() {
      const buttons = document.querySelectorAll(".tab-btn");
      const panels = document.querySelectorAll(".panel");

      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          const target = btn.getAttribute("data-tab");
          buttons.forEach(b => b.classList.remove("active"));
          panels.forEach(p => p.classList.remove("active"));
          btn.classList.add("active");
          document.querySelector(`.panel[data-panel="${target}"]`).classList.add("active");
        });
      });
    }

    function initTodayLabel() {
      const label = document.getElementById("todayLabel");
      const d = new Date();
      const opts = { month: "long", day: "numeric", weekday: "short" };
      label.textContent = d.toLocaleDateString("zh-CN", opts);
    }

    document.addEventListener("DOMContentLoaded", () => {
      initTabs();
      initTodayLabel();
      render(sampleTasks);
    });
  </script>
</body>
</html>