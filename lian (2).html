<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>AIç«‹æ¡ˆåŠ©æ‰‹ï¼ˆæ·±è“ç‰ˆï¼‰ Â· v4 Demo</title>
<style>
:root{
  --brand:#0b3d91;       /* æ·±è“ä¸»è‰² */
  --brand-2:#3b82f6;     /* æµ…è“é«˜äº® */
  --bg:#f5f7fb;
  --text:#0f172a;
  --muted:#5b6575;
  --card:#ffffff;
  --border:#e3e8ef;
  --shadow:0 6px 20px rgba(11,61,145,0.08);
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background:var(--bg);color:var(--text);}
.container{max-width:720px;margin:0 auto;padding:16px;}
header{text-align:center;padding:28px 16px 10px;}
header h1{font-size:22px;color:var(--brand);letter-spacing:0.5px;}
header p{color:var(--muted);font-size:14px;margin-top:4px;}
.card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:24px;margin-top:14px;box-shadow:var(--shadow);}
.hide{display:none;}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:14px 18px;border-radius:16px;font-weight:700;border:none;cursor:pointer;transition:.18s background,.18s transform,font-size .18s;font-size:16px;}
.btn:active{transform:scale(.98);}
.btn.primary{background:var(--brand);color:#fff;}
.btn.secondary{background:#fff;color:var(--brand);border:1px solid var(--brand);}
.btn.ghost{background:transparent;color:var(--brand);}
.btn.block{width:100%;}
.nav-row{display:flex;justify-content:space-between;gap:8px;margin-top:12px;}
.nav-row .left{flex:1;}
.nav-row .right{flex:1;text-align:right;}
.input,textarea,select{width:100%;padding:12px 14px;border:1px solid var(--border);border-radius:12px;margin-top:10px;font-size:15px;background:#fff;}
textarea{min-height:120px;}
.section-title{font-size:18px;font-weight:800;margin-bottom:10px;color:#0d1b2a;}
.tip{font-size:13px;color:var(--muted);margin-top:6px;}
.numbered{counter-reset:item;margin-left:0;list-style:none;}
.numbered li{counter-increment:item;margin:10px 0 10px 0;position:relative;padding-left:36px;font-size:14px;line-height:1.6;color:var(--text);}
.numbered li::before{content:counter(item) ".";position:absolute;left:0;top:0;color:#fff;background:var(--brand);width:26px;height:26px;display:grid;place-items:center;border-radius:8px;font-weight:800;}
.voice-btn{width:100%;padding:22px;background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;font-weight:800;border:none;border-radius:18px;font-size:18px;position:relative;box-shadow:0 8px 18px rgba(11,61,145,0.2);}
.voice-btn::after{content:"";position:absolute;inset:-2px;border-radius:20px;padding:2px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);-webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);-webkit-mask-composite:xor;mask-composite:exclude;animation:borderflow 3s linear infinite;}
@keyframes borderflow{0%{transform:translateX(-20%)}100%{transform:translateX(20%)}}
.item-list{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px;}
.item{border:1px dashed var(--border);border-radius:12px;padding:12px;background:#fff;}
.item .title{font-weight:700;margin-bottom:6px;}
.file-list{font-size:13px;color:var(--muted);margin-top:6px;}
.preview-area{background:#f1f5fb;border:1px solid var(--border);border-radius:12px;padding:12px;white-space:pre-wrap;font-size:13px;}
.preview-area[contenteditable="true"]{outline:none;}
.fee-box{margin-top:12px;padding:12px;border:1px solid var(--border);background:#f8fbff;border-radius:12px;}
.fee-box b{color:#0d9488;}
.carousel{position:relative;margin-top:10px;}
.track{display:flex;overflow-x:auto;gap:12px;scroll-snap-type:x mandatory;padding-bottom:6px;}
.slide{flex:0 0 90%;scroll-snap-align:center;background:#fff;border:1px solid var(--border);border-radius:16px;padding:18px;box-shadow:0 4px 12px rgba(0,0,0,.05);min-height:360px;display:flex;flex-direction:column;}
.slide h4{margin:10px 0 8px;color:var(--brand);}
.placeholder{background:#eef2ff;border:1px dashed #c7d2fe;border-radius:12px;height:180px;display:grid;place-items:center;color:#475569;font-size:14px;}
.placeholder span{font-size:22px;margin-right:6px;}
.slide p{font-size:14.5px;line-height:1.7;margin-top:8px;}
.dots{display:flex;justify-content:center;gap:6px;margin-top:10px;}
.dot{width:8px;height:8px;border-radius:999px;background:#c9d4ff;}
.dot.active{background:var(--brand);}
.fab{position:fixed;right:16px;bottom:18px;width:56px;height:56px;border-radius:50%;background:var(--brand);color:#fff;display:grid;place-items:center;font-size:24px;box-shadow:0 10px 24px rgba(11,61,145,0.3);z-index:50;cursor:pointer;}
.fab::after{content:"";position:absolute;inset:0;border-radius:50%;box-shadow:0 0 0 0 rgba(11,61,145,0.25);animation:pulse 2.2s infinite;}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(11,61,145,0.25)}70%{box-shadow:0 0 0 16px rgba(11,61,145,0)}100%{box-shadow:0 0 0 0 rgba(11,61,145,0)}}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#0f172a;color:#fff;padding:10px 14px;border-radius:999px;opacity:0;transition:.3s;z-index:60;}
.toast.show{opacity:1;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:70;}
.modal .dialog{background:#fff;border-radius:16px;padding:18px;max-width:88%;box-shadow:var(--shadow);}
.modal .dialog h4{margin-bottom:6px;}
.modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:10px;}
.stepbar{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:13px;margin-bottom:10px;}
.stepdot{width:8px;height:8px;border-radius:999px;background:#cdd5e1;}
.stepdot.active{background:var(--brand);}
</style>
</head>
<body>

<header>
  <h1>AIç«‹æ¡ˆåŠ©æ‰‹ï¼ˆæ·±è“ç‰ˆï¼‰</h1>
  <p>è®©ç«‹æ¡ˆæ–‡ä¹¦ç”Ÿæˆä¸æŒ‡å¯¼æ›´ç®€å•</p>
</header>

<main class="container">

  <!-- æ¬¢è¿ -->
  <section id="welcome" class="card">
    <div class="stepbar"><span class="stepdot active"></span><span>æ¬¢è¿é¡µ</span></div>
    <p style="font-size:15px;">AIè‡ªåŠ¨ç”Ÿæˆèµ·è¯‰çŠ¶ã€è¯æ®ç›®å½•ä¸ç«‹æ¡ˆæŒ‡å¯¼ï¼Œé€‚é…æ‰‹æœºç«¯ï¼Œæµç¨‹æ¸…æ™°ã€‚</p>
    <div class="nav-row">
      <div class="left"></div>
      <div class="right"><button class="btn primary" id="startBtn">å¼€å§‹ç«‹æ¡ˆæŒ‡å¯¼ âœ</button></div>
    </div>
  </section>

  <!-- ä½¿ç”¨æç¤º -->
  <section id="intro" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>ä½¿ç”¨æç¤º</span></div>
    <ol class="numbered">
      <li>è¯­éŸ³è¾“å…¥æ›´å¿«æ·ï¼Œä¹Ÿå¯æ‰‹åŠ¨è¾“å…¥ã€‚</li>
      <li>è‡ªåŠ¨è¯†åˆ«æ¡ˆä»¶ç±»å‹å¹¶æç¤ºè¡¥å……å…³é”®ä¿¡æ¯ã€‚</li>
      <li>å»ºè®®ä¸Šä¼ ææ–™å¯ç¼ºçœï¼Œç¨åä»å¯è¡¥å……ã€‚</li>
      <li>ç”Ÿæˆåå¯ç›´æ¥ä¿®æ”¹æ–‡ä¹¦ï¼Œå†è¿›è¡Œæ”¯ä»˜ä¸æ‰“å°ã€‚</li>
    </ol>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" id="introPrev">â† è¿”å›</button></div>
      <div class="right"><button class="btn primary" id="goStep1">ä¸‹ä¸€æ­¥ â†’</button></div>
    </div>
  </section>

  <!-- Step1 è¾“å…¥èƒŒæ™¯ -->
  <section id="step1" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 1/7</span></div>
    <h3 class="section-title">â‘  æè¿°æ¡ˆä»¶èƒŒæ™¯</h3>
    <button class="voice-btn" id="voiceBtn">ğŸ§ ç‚¹å‡»å¼€å§‹è¯­éŸ³è¾“å…¥</button>
    <textarea id="caseInput" placeholder="æˆ–åœ¨æ­¤è¾“å…¥æ¡ˆä»¶èƒŒæ™¯ï¼šäººç‰©ã€æ—¶é—´ã€åœ°ç‚¹ã€é‡‘é¢ã€ç»è¿‡..."></textarea>
    <p class="tip">ç¤ºä¾‹ï¼š2024å¹´6æœˆåœ¨XXå•†åœºè´­ä¹°æ‰‹æœºï¼Œ5å¤©åå‘ç°è´¨é‡é—®é¢˜è¦æ±‚é€€è´§è¢«æ‹’ï¼Œä¿ç•™å‘ç¥¨å’ŒèŠå¤©è®°å½•ã€‚</p>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="welcome">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right"><button class="btn primary" id="toStep2">ä¸‹ä¸€æ­¥ â†’</button></div>
    </div>
  </section>

  <!-- Step2 è¡¥å……ä¿¡æ¯ + ä¸Šä¼ æ–‡ä»¶ -->
  <section id="step2" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 2/7</span></div>
    <h3 class="section-title">â‘¡ è¡¥å……ä¿¡æ¯ & ä¸Šä¼ ææ–™</h3>
    <div id="caseType" class="tip">è¯†åˆ«ç±»å‹ï¼š<b id="caseTypeLabel">å¾…è¯†åˆ«</b></div>
    <input class="input" placeholder="åŸå‘Šå§“å*" id="p_name" />
    <input class="input" placeholder="è¢«å‘Šï¼ˆå•†å®¶/å¯¹æ–¹ï¼‰åç§°*" id="d_name" />
    <input class="input" placeholder="æ¶‰æ¡ˆé‡‘é¢ï¼ˆå…ƒï¼Œå¯é€‰ï¼‰" id="amount" />
    <div class="item-list">
      <div class="item">
        <div class="title">å»ºè®®ä¸Šä¼ ææ–™ï¼ˆå¯ç¼ºçœï¼‰</div>
        <div class="tip">ğŸ§¾ å‘ç¥¨/æ”¶æ®ã€ğŸ’¬ èŠå¤©è®°å½•æˆªå›¾ã€ğŸ“„ åˆåŒ/å€Ÿæ¡/æ‰¿è¯ºä¹¦ç­‰ã€‚</div>
        <input type="file" multiple id="fileUpload" class="input" />
        <div id="fileList" class="file-list"></div>
      </div>
    </div>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="step1">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right"><button class="btn primary" id="toStep3">ç”Ÿæˆæ–‡ä¹¦ â†’</button></div>
    </div>
  </section>

  <!-- Step3 ç”Ÿæˆå¹¶å¯ç¼–è¾‘ + è¯‰è®¼è´¹æµ‹ç®— -->
  <section id="step3" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 3/7</span></div>
    <h3 class="section-title">â‘¢ ç”Ÿæˆå¹¶ç¼–è¾‘æ–‡ä¹¦</h3>
    <p class="tip" id="loadingText">æ­£åœ¨ç”Ÿæˆ...</p>
    <div id="docsArea" class="hide">
      <div style="font-weight:800;margin:8px 0 6px 0;">ã€èµ·è¯‰çŠ¶ã€‘</div>
      <div id="petition" class="preview-area" contenteditable="true"></div>
      <div style="font-weight:800;margin:16px 0 6px 0;">ã€è¯æ®ç›®å½•ã€‘</div>
      <div id="evidence" class="preview-area" contenteditable="true"></div>

      <div class="fee-box" id="feeBox">
        <div style="font-weight:800;margin-bottom:6px;">ğŸ’° è¯‰è®¼è´¹æµ‹ç®—ï¼ˆç¤ºæ„ï¼‰</div>
        <div id="feeText" class="tip">æ ¹æ®å¡«å†™çš„æ¶‰æ¡ˆé‡‘é¢è‡ªåŠ¨ä¼°ç®—ï¼ˆä»¥æ³•é™¢æœ€ç»ˆæ ¸å®šä¸ºå‡†ï¼‰ã€‚</div>
      </div>

      <div class="nav-row">
        <div class="left"><button class="btn secondary" data-prev="step2">â† ä¸Šä¸€æ­¥</button></div>
        <div class="right"><button class="btn primary" id="toStep4">ç¡®è®¤æ— è¯¯ï¼Œå»æ”¯ä»˜ â†’</button></div>
      </div>
    </div>
  </section>

  <!-- Step4 æ”¯ä»˜ -->
  <section id="step4" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 4/7</span></div>
    <h3 class="section-title">â‘£ æ”¯ä»˜</h3>
    <p style="margin-bottom:10px;">AIç«‹æ¡ˆæ–‡ä¹¦ï¼ˆèµ·è¯‰çŠ¶ + è¯æ®ç›®å½•ï¼‰ <b>Â¥9.9</b></p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <button class="btn primary" id="mockPay">æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ</button>
    </div>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="step3">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right"><button class="btn primary" id="toStep5">ä¸‹ä¸€æ­¥ â†’</button></div>
    </div>
  </section>

  <!-- Step5 ä¸‹è½½ / äº‘æ‰“å° -->
  <section id="step5" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 5/7</span></div>
    <h3 class="section-title">â‘¤ ä¸‹è½½ & äº‘æ‰“å°</h3>
    <div class="item-list">
      <div class="item">
        <div class="title">ä¸‹è½½æ–‡ä¹¦</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:6px;">
          <button class="btn secondary" id="dlPetitionDoc">èµ·è¯‰çŠ¶.DOC</button>
          <button class="btn secondary" id="dlEvidenceDoc">è¯æ®ç›®å½•.DOC</button>
          <button class="btn ghost" id="dlPetitionTxt">èµ·è¯‰çŠ¶.TXT</button>
          <button class="btn ghost" id="dlEvidenceTxt">è¯æ®ç›®å½•.TXT</button>
        </div>
      </div>
      <div class="item">
        <div class="title">äº‘æ‰“å°ï¼ˆå¯é€‰ï¼‰</div>
        <input class="input" placeholder="æ”¶ä»¶äººå§“å" id="addrName" />
        <input class="input" placeholder="æ‰‹æœºå·ç " id="addrPhone" />
        <input class="input" placeholder="æ”¶ä»¶åœ°å€" id="addrFull" />
        <div style="margin-top:8px;text-align:right;">
          <button class="btn secondary" id="submitPrint">æäº¤æ‰“å°ï¼ˆæ¼”ç¤ºï¼‰</button>
        </div>
      </div>
    </div>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="step4">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right"><button class="btn primary" id="toStep6">ä¸‹ä¸€æ­¥ï¼šç­¾ç½²æŒ‡å¯¼ â†’</button></div>
    </div>
  </section>

  <!-- Step6 ç­¾ç½²æŒ‡å¯¼ï¼ˆé«˜å¡ç‰‡ + å›¾ç‰‡å ä½ï¼‰ -->
  <section id="step6" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 6/7</span></div>
    <h3 class="section-title">â‘¥ ç­¾ç½²æŒ‡å¯¼</h3>
    <div class="carousel">
      <div class="track" id="trackSign">
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>ç­¾åä½ç½®ç¤ºæ„å›¾ï¼ˆå ä½ï¼‰</div>
          <h4>æ­¥éª¤1ï¼šç­¾åè¦æ±‚</h4>
          <p>å½“äº‹äººé€é¡µç­¾åï¼Œä½¿ç”¨é»‘è‰²æ°´ç¬”æˆ–ç­¾å­—ç¬”ï¼Œé¿å…é“…ç¬”/è“è‰²åœ†ç ç¬”ï¼›è‹¥ä»£ç­¾éœ€é™„æˆæƒè¯æ˜ã€‚</p>
        </div>
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>éª‘ç¼ç« ç¤ºæ„å›¾ï¼ˆå ä½ï¼‰</div>
          <h4>æ­¥éª¤2ï¼šå…¬å¸ç›–ç« </h4>
          <p>å…¬å¸ä¸»ä½“éœ€åŠ ç›–ä¸ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ä¸€è‡´çš„å…¬ç« ï¼›è£…è®¢å¤„å¯åŠ éª‘ç¼ç« ï¼Œç¡®ä¿å®Œæ•´æ€§ã€‚</p>
        </div>
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>ä¿®æ”¹å¤„åˆ’çº¿ç¤ºæ„å›¾ï¼ˆå ä½ï¼‰</div>
          <h4>æ­¥éª¤3ï¼šæ¶‚æ”¹ç¡®è®¤</h4>
          <p>å¦‚æœ‰ä¿®æ”¹ï¼Œåœ¨ä¿®æ”¹å¤„åˆ’çº¿å¹¶ç”±ç­¾åäººç­¾åç¡®è®¤ï¼Œé¿å…è¯æ®æ•ˆåŠ›äº‰è®®ã€‚</p>
        </div>
      </div>
      <div class="dots" id="dotsSign"></div>
    </div>
    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="step5">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right"><button class="btn primary" id="toStep7">ä¸‹ä¸€æ­¥ï¼šç«‹æ¡ˆæŒ‡å¯¼ â†’</button></div>
    </div>
  </section>

  <!-- Step7 ç«‹æ¡ˆæŒ‡å¯¼ï¼ˆé«˜å¡ç‰‡ + å›¾ç‰‡å ä½ + å®Œæˆç«‹æ¡ˆæŒ‰é’®ï¼‰ -->
  <section id="step7" class="card hide">
    <div class="stepbar"><span class="stepdot active"></span><span>æ­¥éª¤ 7/7</span></div>
    <h3 class="section-title">â‘¦ ç«‹æ¡ˆæŒ‡å¯¼</h3>
    <div class="carousel">
      <div class="track" id="trackFile">
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>ææ–™æ¸…å•ç¤ºæ„å›¾ï¼ˆå ä½ï¼‰</div>
          <h4>å‡†å¤‡ææ–™</h4>
          <p>æ‰“å°çš„èµ·è¯‰çŠ¶ã€è¯æ®ç›®å½•ã€èº«ä»½è¯å¤å°ä»¶ã€è¯æ®å¤å°ä»¶ã€å½“äº‹äººè”ç³»æ–¹å¼ç­‰ã€‚</p>
        </div>
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>çº¿ä¸Šæäº¤ç•Œé¢ç¤ºæ„ï¼ˆå ä½ï¼‰</div>
          <h4>æäº¤æ–¹å¼</h4>
          <p>å‰å¾€å—ç†æ³•é™¢ç«‹æ¡ˆåº­æˆ–é€šè¿‡â€œç§»åŠ¨å¾®æ³•é™¢â€APPçº¿ä¸Šæäº¤ï¼ŒæŒ‰æŒ‡å¼•å¡«å†™ä¿¡æ¯å¹¶ä¸Šä¼ ææ–™ã€‚</p>
        </div>
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>ç¼´è´¹äºŒç»´ç ç¤ºä¾‹ï¼ˆå ä½ï¼‰</div>
          <h4>è¯‰è®¼è´¹ç¼´çº³</h4>
          <p>æŒ‰è¯‰è¯·é‡‘é¢ç”±æ³•é™¢æ”¶å–ï¼Œé€šå¸¸æ”¯æŒç”µå­ç¼´è´¹ï¼›ä¿ç•™ç¼´è´¹å‡­è¯ä»¥å¤‡æŸ¥éªŒã€‚</p>
        </div>
        <div class="slide">
          <div class="placeholder"><span>ğŸ–¼ï¸</span>å—ç†é€šçŸ¥ç¤ºæ„ï¼ˆå ä½ï¼‰</div>
          <h4>å—ç†é€šçŸ¥</h4>
          <p>ç­‰å¾…å—ç†ç»“æœï¼›å¦‚éœ€è¡¥å……ææ–™æŒ‰é€šçŸ¥å®Œå–„ã€‚å»ºè®®ä¿ç•™çŸ­ä¿¡/APPé€šçŸ¥æˆªå›¾ã€‚</p>
        </div>
      </div>
      <div class="dots" id="dotsFile"></div>
    </div>

    <div class="nav-row">
      <div class="left"><button class="btn secondary" data-prev="step6">â† ä¸Šä¸€æ­¥</button></div>
      <div class="right">
        <button class="btn primary" id="doneFiling">å®Œæˆç«‹æ¡ˆ âœ…</button>
      </div>
    </div>
  </section>

</main>

<!-- æ‚¬æµ®äººå·¥å®¢æœæŒ‰é’®ï¼ˆheadsetï¼‰ -->
<div class="fab" id="fab" title="äººå·¥å®¢æœ">ğŸ§</div>

<!-- ç®€æ˜“å®¢æœå¼¹çª— -->
<div class="modal" id="supportModal">
  <div class="dialog">
    <h4>äººå·¥å®¢æœ</h4>
    <p style="font-size:14px;color:var(--muted);margin-top:6px;">æˆ‘ä»¬å·²æ”¶åˆ°æ‚¨çš„è¯·æ±‚ï¼Œç¨åä¼šæœ‰å®¢æœä¸æ‚¨è”ç³»ï¼ˆæ¼”ç¤ºï¼‰ã€‚</p>
    <div class="actions">
      <button class="btn secondary" id="closeSupport">å…³é—­</button>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
const toast=(msg)=>{const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1800);};
const show=(id)=>{['welcome','intro','step1','step2','step3','step4','step5','step6','step7'].forEach(s=>document.getElementById(s).classList.add('hide'));document.getElementById(id).classList.remove('hide');window.scrollTo({top:0,behavior:'smooth'});};

// æ¬¢è¿ â†’ æç¤º â†’ æ­¥éª¤1
document.getElementById('startBtn').onclick=()=>show('intro');
document.getElementById('introPrev').onclick=()=>show('welcome');
document.getElementById('goStep1').onclick=()=>show('step1');

// é€šç”¨â€œä¸Šä¸€æ­¥â€æŒ‰é’®ï¼ˆdata-prevå±æ€§ï¼‰
document.querySelectorAll('[data-prev]').forEach(btn=>{
  btn.addEventListener('click',()=>show(btn.getAttribute('data-prev')));
});

// è¯­éŸ³è¾“å…¥
let recognition;
try{const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(SR){recognition=new SR();recognition.lang='zh-CN';recognition.onresult=(e)=>{const t=Array.from(e.results).map(r=>r[0].transcript).join(' ');document.getElementById('caseInput').value+=(document.getElementById('caseInput').value?' ':'')+t;};}}catch(e){}
document.getElementById('voiceBtn').onclick=()=>{if(!recognition){toast('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¾“å…¥');return;}recognition.start();toast('å¼€å§‹å½•éŸ³â€¦');};

// ç®€æ˜“åˆ†ç±»
function classifyCase(text){
  const t=text||'';
  const has=(w)=>t.includes(w);
  if(has('å€Ÿ')&&(has('æ¬ ')||has('è¿˜')||has('å€Ÿæ¡'))) return {label:'æ°‘é—´å€Ÿè´·çº çº·'};
  if(has('åˆåŒ')||has('è¿çº¦')||has('äº¤ä»˜')||has('ä»·æ¬¾')) return {label:'åˆåŒçº çº·'};
  if(has('é€€è´§')||has('å”®å')||has('è´¨é‡')||has('æ‰‹æœº')||has('å•†å®¶')) return {label:'æ¶ˆè´¹è€…æƒç›Šçº çº·'};
  if(has('åŠ³åŠ¨')||has('åŠ ç­')||has('å·¥èµ„')||has('è¾èŒ')||has('ç¤¾ä¿')) return {label:'åŠ³åŠ¨äº‰è®®'};
  return {label:'ä¸€èˆ¬æ°‘äº‹çº çº·'};
}

// Step1 â†’ Step2
document.getElementById('toStep2').onclick=()=>{
  const text=document.getElementById('caseInput').value.trim();
  if(!text){toast('è¯·å…ˆè¾“å…¥æˆ–é€šè¿‡è¯­éŸ³æè¿°æ¡ˆä»¶èƒŒæ™¯');return;}
  const type=classifyCase(text);
  document.getElementById('caseTypeLabel').textContent=type.label;
  show('step2');
};

// æ–‡ä»¶ä¸Šä¼ åˆ—è¡¨
document.getElementById('fileUpload').addEventListener('change',()=>{
  const list=Array.from(document.getElementById('fileUpload').files).map(f=>`${f.name} (${Math.round(f.size/1024)}KB)`).join('ï¼Œ');
  document.getElementById('fileList').textContent=list?('å·²é€‰æ‹©ï¼š'+list):'';
});

// è¯‰è®¼è´¹æµ‹ç®—ï¼ˆç¤ºæ„ç®—æ³•ï¼‰
function estimateFee(amount){
  const a=Number(amount);
  if(!isFinite(a)||a<=0) return 'æœªå¡«å†™é‡‘é¢ï¼Œæš‚æ— æ³•ä¼°ç®—ã€‚';
  // ç®€åŒ–ç¤ºæ„ï¼šçº¦ 2.5%ï¼ˆæœ€ä½Â¥50ï¼Œå‘ä¸Šå–æ•´ï¼‰ï¼Œä»…ä¾›æ¼”ç¤º
  const fee=Math.max(50, Math.ceil(a*0.025));
  return `é¢„è®¡è¯‰è®¼è´¹çº¦ Â¥${fee}ï¼ˆç¤ºæ„ï¼‰ï¼Œå…·ä½“ä»¥æ³•é™¢å®é™…æ ¸å®šä¸ºå‡†ã€‚`;
}

// Step2 â†’ Step3ï¼ˆç”Ÿæˆï¼‰
document.getElementById('toStep3').onclick=()=>{
  if(!document.getElementById('p_name').value.trim()||!document.getElementById('d_name').value.trim()){toast('è¯·å®Œå–„åŸå‘Šä¸è¢«å‘Šåç§°');return;}
  show('step3');
  setTimeout(()=>{
    document.getElementById('loadingText').classList.add('hide');
    const petitioner=document.getElementById('p_name').value||'åŸå‘Š';
    const defendant=document.getElementById('d_name').value||'è¢«å‘Š';
    const amount=document.getElementById('amount').value||'____';
    const petition=`æ°‘  äº‹  èµ·  è¯‰  çŠ¶\n\nåŸå‘Šï¼š${petitioner}\nè¢«å‘Šï¼š${defendant}\n\nä¸€ã€åŸºæœ¬äº‹å®\nåŸå‘Šä¸è¢«å‘Šå› æ¶ˆè´¹è¡Œä¸ºäº§ç”Ÿçº çº·ï¼Œè¢«å‘Šæ‹’ç»é€€è´§æˆ–é€€æ¬¾ã€‚\näºŒã€è¯‰è®¼è¯·æ±‚\n1. é€€è´§å¹¶è¿”è¿˜è´§æ¬¾äººæ°‘å¸ ${amount} å…ƒï¼›\n2. èµ”å¿æ£€æµ‹è´¹åŠåˆç†ç»´æƒæ”¯å‡ºï¼›\n3. è¯‰è®¼è´¹ç”±è¢«å‘Šæ‰¿æ‹…ã€‚\n\næ­¤è‡´\n___äººæ°‘æ³•é™¢\n\nå…·çŠ¶äººï¼š${petitioner}\næ—¥æœŸï¼š______å¹´__æœˆ__æ—¥\n`;
    const evidence=`è¯ æ® ç›® å½•\n\nåŸå‘Šï¼š${petitioner}\nè¢«å‘Šï¼š${defendant}\n\n1. å‘ç¥¨/å°ç¥¨å¤å°ä»¶ï¼›\n2. å•†å“é—®é¢˜ç…§ç‰‡æˆ–æ£€æµ‹æŠ¥å‘Šï¼›\n3. ä¸å•†å®¶æ²Ÿé€šè®°å½•ï¼ˆèŠå¤©/ç”µè¯ï¼‰ï¼›\n4. å…¶ä»–ä¸æœ¬æ¡ˆæœ‰å…³çš„è¯æ®ã€‚`;
    document.getElementById('petition').textContent=petition;
    document.getElementById('evidence').textContent=evidence;
    document.getElementById('docsArea').classList.remove('hide');
    // è¯‰è®¼è´¹æç¤º
    document.getElementById('feeText').textContent=estimateFee(amount);
  },700);
};

// Step3 â†’ Step4
document.getElementById('toStep4').onclick=()=>show('step4');

// æ”¯ä»˜
document.getElementById('mockPay').onclick=()=>{toast('æ”¯ä»˜æˆåŠŸï¼ˆæ¼”ç¤ºï¼‰');};
document.getElementById('toStep5').onclick=()=>show('step5');

// ä¸‹è½½/æ‰“å°
function saveDoc(filename, content){
  const html=`<!DOCTYPE html><html><head><meta charset="utf-8"></head><body><pre style="white-space:pre-wrap;font-family:SimSun,serif;">${content.replace(/[&<>"]/g,s=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[s]))}</pre></body></html>`;
  const blob=new Blob([html],{type:'application/msword'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=filename;a.click();URL.revokeObjectURL(a.href);
}
function saveTxt(filename, content){
  const blob=new Blob([content],{type:'text/plain;charset=utf-8'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=filename;a.click();URL.revokeObjectURL(a.href);
}
document.getElementById('dlPetitionDoc').onclick=()=>saveDoc('èµ·è¯‰çŠ¶.doc',document.getElementById('petition').innerText);
document.getElementById('dlEvidenceDoc').onclick=()=>saveDoc('è¯æ®ç›®å½•.doc',document.getElementById('evidence').innerText);
document.getElementById('dlPetitionTxt').onclick=()=>saveTxt('èµ·è¯‰çŠ¶.txt',document.getElementById('petition').innerText);
document.getElementById('dlEvidenceTxt').onclick=()=>saveTxt('è¯æ®ç›®å½•.txt',document.getElementById('evidence').innerText);
document.getElementById('submitPrint').onclick=()=>{
  const n=document.getElementById('addrName').value.trim();
  const p=document.getElementById('addrPhone').value.trim();
  const a=document.getElementById('addrFull').value.trim();
  if(!n||!p||!a){toast('è¯·å¡«å†™å§“åã€æ‰‹æœºå’Œåœ°å€');return;}
  toast('äº‘æ‰“å°å·²æäº¤ï¼ˆæ¼”ç¤ºï¼‰');
};

// Step5 â†’ Step6 â†’ Step7
document.getElementById('toStep6').onclick=()=>show('step6');
document.getElementById('toStep7').onclick=()=>show('step7');

// å®Œæˆç«‹æ¡ˆï¼šæç¤ºåç»­ç¨‹åº
document.getElementById('doneFiling').onclick=()=>{
  toast('ç«‹æ¡ˆå®Œæˆï¼åç»­ï¼šåˆ†æ¡ˆä¸é€è¾¾ â†’ è¯æ®äº¤æ¢ â†’ åº­å‰è°ƒè§£/æ’æœŸ â†’ å¼€åº­å®¡ç† â†’ åˆ¤å†³/è°ƒè§£ä¹¦ â†’ æ‰§è¡Œã€‚');
};

// å®¢æœ
document.getElementById('fab').onclick=()=>{document.getElementById('supportModal').style.display='flex';};
document.getElementById('closeSupport').onclick=()=>{document.getElementById('supportModal').style.display='none';};

// è·¯ä¹¦åœ†ç‚¹æŒ‡ç¤ºå™¨
function initDots(trackId,dotsId){
  const track=document.getElementById(trackId);
  const dots=document.getElementById(dotsId);
  const slides=track.querySelectorAll('.slide');
  dots.innerHTML='';
  slides.forEach((_,i)=>{const d=document.createElement('span');d.className='dot'+(i===0?' active':'');dots.appendChild(d);});
  const dotEls=[...dots.querySelectorAll('.dot')];
  track.addEventListener('scroll',()=>{
    const idx=Math.round(track.scrollLeft/(track.scrollWidth/ slides.length));
    dotEls.forEach((el,i)=>el.classList.toggle('active',i===idx));
  });
}
initDots('trackSign','dotsSign');
initDots('trackFile','dotsFile');
</script>
</body>
</html>
